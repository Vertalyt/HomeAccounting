import{_ as k,u as B,b as d,f as F,N as w,E as R,V as W,g as L,o as a,c as r,a as t,O as P,U as N,n as A,t as l,P as K,F as D,r as G,v,q as V,j as b,e as q,A as X,i as T,s as E,k as Y}from"./index-dc28a2c1.js";import{u as j,a as x,b as H,c as Z}from"./index.esm-25c10212.js";import{a as $,E as ee}from"./ElementRestor-219304de.js";import{L as te}from"./LoginPasswordForm-e421a45b.js";const oe={name:"ProfileInfo",props:["infoProfile"],setup(o){const n=B(),s=d(),e=d(),u=d(o.infoProfile.locale),{isSubmitting:m,handleSubmit:i}=j({initialValues:{nameProfile:o.infoProfile.name}}),{value:c,errorMessage:_,handleBlur:f}=x("nameProfile",H().trim().required("Введите имя")),h=i(async p=>{const g={name:p.nameProfile,role:o.infoProfile.role,locale:u.value};await n.dispatch("requests/updateInfo",g)});return F(()=>{w.updateTextFields(),s.value=w.FormSelect.init(e.value)}),R(()=>{s.value&&s.value.destroy&&s.value.destroy()}),{nValue:c,nError:_,nBlur:f,isSubmitting:m,onSubmit:h,selectCategory:e,localeFlag:W,locale:u,getLocalizedText:L}}},ie={class:"col s12 m12"},ne={class:"card-content"},le={class:"input-field"},ae={for:"nameProfile"},se={class:"input-field",id:"locale"},de=["value"],re=["disabled"],ce=t("i",{class:"material-icons right"},"send",-1);function ue(o,n,s,e,u,m){return a(),r("div",ie,[t("form",{onSubmit:n[3]||(n[3]=V((...i)=>e.onSubmit&&e.onSubmit(...i),["prevent"]))},[t("div",ne,[t("div",le,[P(t("input",{id:"nameProfile",type:"text","onUpdate:modelValue":n[0]||(n[0]=i=>e.nValue=i),class:A({invalid:e.nError}),onBlur:n[1]||(n[1]=(...i)=>e.nBlur&&e.nBlur(...i))},null,34),[[N,e.nValue]]),t("label",ae,l(e.getLocalizedText("name")),1),t("span",{class:A(["helper-text",{invalid:e.nError}])},l(e.nError),3)]),t("div",se,[P(t("select",{ref:"selectCategory","onUpdate:modelValue":n[2]||(n[2]=i=>e.locale=i)},[(a(!0),r(D,null,G(e.localeFlag,i=>(a(),r("option",{key:i.flag,value:i.flag},l(i.value),9,de))),128))],512),[[K,e.locale]]),t("label",null,l(e.getLocalizedText("localeSite")),1)]),t("button",{class:"btn waves-effect waves-light",type:"submit",disabled:e.isSubmitting},[v(l(e.getLocalizedText("refresh"))+" ",1),ce],8,re)])],32)])}const me=k(oe,[["render",ue]]);function he(o,{emit:n}){const{isSubmitting:e,handleSubmit:u}=j(),m=B(),i=d(),c=d(),_=d(),{value:f,errorMessage:h,handleBlur:p}=x("nameCard",H().trim().required(L("EnterCategoryName"))),{value:g,errorMessage:y,handleBlur:S}=x("limitCard",Z().required(L("EnterLimit")).min(5e3,`${L("LimitCannotBeLess")} 5000.`));g.value=5e3;const z=u(async(M,{resetForm:I})=>{try{await m.dispatch("card/create",{title:M.nameCard,limit:M.limitCard,bill:M.limitCard,isDetected:!1,type:_.value}),I(),g.value=5e3,n("created")}catch{}});return F(()=>{w.updateTextFields(),c.value=w.FormSelect.init(i.value)}),R(()=>{c.value&&c.value.destroy&&c.value.destroy()}),{isSubmitting:e,nValue:f,nError:h,nBlur:p,lValue:g,lError:y,lBlur:S,onSubmit:z,selectCard:i,current:_,getLocalizedText:L}}const ge={name:"CardCreate",emits:["created"],setup(o,{emit:n}){return{...he(o,{emit:n})}}},_e={class:"col s12 m12"},fe={class:"input-field"},pe={value:"",disabled:"",selected:""},ve={value:"debit"},be={value:"credit"},Le={value:"cash"},ye={class:"input-field"},Ce={for:"nameCard"},Te={class:"input-field"},Me={for:"limitCard"},Ee={class:"input-field"},Ae=["disabled"],Pe=t("i",{class:"material-icons right"},"send",-1);function we(o,n,s,e,u,m){return a(),r("div",_e,[t("form",{onSubmit:n[5]||(n[5]=V((...i)=>o.onSubmit&&o.onSubmit(...i),["prevent"]))},[t("div",fe,[P(t("select",{ref:"selectCard","onUpdate:modelValue":n[0]||(n[0]=i=>o.current=i),required:""},[t("option",pe,l(o.getLocalizedText("ChooseCardType")),1),t("option",ve,l(o.getLocalizedText("Debits")),1),t("option",be,l(o.getLocalizedText("Credits")),1),t("option",Le,l(o.getLocalizedText("Сash")),1)],512),[[K,o.current]])]),t("div",ye,[P(t("input",{id:"nameCard",type:"text","onUpdate:modelValue":n[1]||(n[1]=i=>o.nValue=i),class:A({invalid:o.nError}),onBlur:n[2]||(n[2]=(...i)=>o.nBlur&&o.nBlur(...i))},null,34),[[N,o.nValue]]),t("label",Ce,l(o.getLocalizedText("NameRecord")),1),t("span",{class:A(["helper-text",{invalid:o.nError}])},l(o.nError),3)]),t("div",Te,[P(t("input",{id:"limitCard",type:"number","onUpdate:modelValue":n[3]||(n[3]=i=>o.lValue=i),class:A({invalid:o.lError}),onBlur:n[4]||(n[4]=(...i)=>o.lBlur&&o.lBlur(...i))},null,34),[[N,o.lValue]]),t("label",Me,l(o.getLocalizedText("limit")),1),t("span",{class:A(["helper-text",{invalid:o.lError}])},l(o.lError),3)]),t("div",Ee,[t("button",{class:"btn waves-effect waves-light",type:"submit",disabled:o.isSubmitting},[v(l(o.getLocalizedText("Create"))+" ",1),Pe],8,Ae)])],32)])}const Se=k(ge,[["render",we]]),ze={name:"ActiveMethodAuth",props:["loginMetod"],emits:["updated"],setup(o,{emit:n}){const s=B(),e=async m=>{await s.dispatch("auth/unMethodAuth",m),n("updated")},u={"google.com":"Google",password:L("LoginPass")};return{unlinkAuth:e,authTitle:u,getLocalizedText:L}}},Ie={class:"striped highlight centered teal lighten-4",ref:"cardTableRef"},ke={key:0},Be={key:0},Ve={key:0},Ue=["onClick"],Ne=t("i",{class:"material-icons"},"open_in_new",-1),xe=[Ne];function Fe(o,n,s,e,u,m){return a(),r("table",Ie,[s.loginMetod?(a(),r("thead",ke,[t("tr",null,[t("th",null,l(e.getLocalizedText("Type")),1),t("th",null,l(e.getLocalizedText("Account")),1),s.loginMetod.length>1?(a(),r("th",Be,l(e.getLocalizedText("TurnOff")),1)):b("",!0)])])):b("",!0),t("tbody",null,[(a(!0),r(D,null,G(s.loginMetod,i=>(a(),r("tr",{key:i.providerId},[t("td",null,l(e.authTitle[i.providerId]),1),t("td",null,l(i.email),1),s.loginMetod.length>1?(a(),r("td",Ve,[t("a",{href:"#",class:"btn-small btn",onClick:V(c=>e.unlinkAuth(i.providerId),["prevent"])},xe,8,Ue)])):b("",!0)]))),128))])],512)}const Re=k(ze,[["render",Fe]]),Oe={name:"ProfileView",setup(){const o=B(),n=o.getters["requests/clientInfo"],s=d(0),e="card",u="auth/addLoginPass",m="addLoginPass",i="AddLoginPassword",c=d(),_=d(),f=d(),h=d(),p=d(0),g=d(),y=d(!0),S=d([]),z=d([]);async function M(){c.value=await o.dispatch("auth/verificationMethods"),_.value=c.value.find(C=>C.providerId==="password"),g.value=c.value.find(C=>C.providerId==="google.com")}async function I(){const C=await o.getters["card/list"];C.length&&(z.value=C.filter(U=>U.isDetected===!1),S.value=C.filter(U=>U.isDetected===!0))}const O=async()=>{await I(),s.value++},J=async()=>{await M(),p.value++};F(async()=>{y.value=!0,await M(),await I(),setTimeout(()=>{h.value=w.Collapsible.init(f.value)},0),y.value=!1}),R(()=>{h.value&&h.value.destroy&&h.value.destroy()});const Q=async()=>{await o.dispatch("auth/googleAddAuth")};return{getLocalizedText:L,infoProfile:n,update:O,updateKey:q(()=>s.value),updateKeyAuth:q(()=>p.value),updateCount:s,dispatchOnSubmitElement:e,dispatchOnSubmitLogin:u,ButtonLogin:m,titleLogin:i,passwordMetod:_,loginMetod:c,collapsibleRef:f,updateAuth:J,googleAuth:Q,googleMethod:g,cardListEdit:z,loading:y,cardListRestore:S}},components:{ProfileInfo:me,CardCreate:Se,ElementRestor:$,ElementEdit:ee,LoginPasswordForm:te,ActiveMethodAuth:Re,AppLoading:X}},qe={class:"page-title"},Ke={key:1},De={class:"collapsible",ref:"collapsibleRef"},Ge={class:"collapsible-header"},je=t("i",{class:"material-icons"},"account_circle",-1),He={class:"collapsible-body"},Je={class:"collapsible-header"},Qe=t("i",{class:"material-icons"},"login",-1),We={class:"collapsible-body"},Xe={key:0},Ye={class:"collapsible-header"},Ze=t("i",{class:"material-icons"},"rule_folder",-1),$e={class:"collapsible-body"},et={class:"btn"},tt={class:"collapsible-header"},ot=t("i",{class:"material-icons"},"credit_card",-1),it={class:"collapsible-body"},nt={class:"collapsible-header"},lt=t("i",{class:"material-icons"},"redeem",-1),at={class:"collapsible-body"},st={key:0},dt={class:"collapsible-header"},rt=t("i",{class:"material-icons"},"credit_score",-1),ct={class:"collapsible-body"},ut={key:0};function mt(o,n,s,e,u,m){const i=T("AppLoading"),c=T("ProfileInfo"),_=T("ActiveMethodAuth"),f=T("LoginPasswordForm"),h=T("CardCreate"),p=T("ElementEdit"),g=T("ElementRestor");return a(),r("div",null,[t("div",qe,[t("h3",null,l(e.getLocalizedText("profile-title")),1)]),e.loading?(a(),E(i,{key:0})):(a(),r("section",Ke,[t("ul",De,[t("li",null,[t("div",Ge,[je,v(l(e.getLocalizedText("profile-title")),1)]),t("div",He,[Y(c,{infoProfile:e.infoProfile},null,8,["infoProfile"])])]),t("li",null,[t("div",Je,[Qe,v(l(e.getLocalizedText("ActivatedAuthorizationMethods")),1)]),t("div",We,[(a(),E(_,{key:e.updateKeyAuth,loginMetod:e.loginMetod,onUpdated:e.updateAuth},null,8,["loginMetod","onUpdated"]))])]),!e.passwordMetod||!e.googleMethod?(a(),r("li",Xe,[t("div",Ye,[Ze,v(l(e.getLocalizedText("AddendumMethod")),1)]),t("div",$e,[e.passwordMetod?b("",!0):(a(),E(f,{key:e.updateKeyAuth,onUpdated:e.updateAuth,dispatchOnSubmitLogin:e.dispatchOnSubmitLogin,ButtonLogin:e.ButtonLogin,titleLogin:e.titleLogin},null,8,["onUpdated","dispatchOnSubmitLogin","ButtonLogin","titleLogin"])),e.googleMethod?b("",!0):(a(),r("form",{key:1,action:"",onClick:n[0]||(n[0]=V((...y)=>e.googleAuth&&e.googleAuth(...y),["prevent"]))},[t("button",et,l(e.getLocalizedText("AddGoogle")),1)]))])])):b("",!0),t("li",null,[t("div",tt,[ot,v(l(e.getLocalizedText("CreateCard")),1)]),t("div",it,[(a(),E(h,{key:e.updateKey,onCreated:e.update},null,8,["onCreated"]))])]),t("li",null,[t("div",nt,[lt,v(l(e.getLocalizedText("EditCard")),1)]),t("div",at,[e.cardListEdit.length?b("",!0):(a(),r("p",st,l(e.getLocalizedText("NoElementsToEdit")),1)),(a(),E(p,{key:e.updateKey,onUpdated:e.update,dispash:e.dispatchOnSubmitElement},null,8,["onUpdated","dispash"]))])]),t("li",null,[t("div",dt,[rt,v(l(e.getLocalizedText("RestoreCard")),1)]),t("div",ct,[e.cardListRestore.length?b("",!0):(a(),r("p",ut,l(e.getLocalizedText("NoElementsToRestor")),1)),(a(),E(g,{key:e.updateKey,dispash:e.dispatchOnSubmitElement,onUpdated:e.update},null,8,["dispash","onUpdated"]))])])],512)]))])}const pt=k(Oe,[["render",mt]]);export{pt as default};
